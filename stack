If I check that all keys are sane, maybe I can afford to panic if
CalculateAgreement fails, simplifying a lot of code.

I need to use android studio in order to find all uses of some functions to see
if they can be simplified.

- Working on state.
